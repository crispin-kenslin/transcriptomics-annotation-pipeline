{% extends "base.html" %}
{% block title %}Help{% endblock %}
{% block content %}
<section class="card">
    <div class="card-header">
        <div>
            <p class="eyebrow">Support</p>
            <h1>Help</h1>
        </div>
    </div>

    <div class="help-layout">
        <aside class="help-nav">
            <h3 class="nav-title">Help navigation</h3>
            <ul>
                <li><a href="#input-format">Input format</a></li>
                <li><a href="#thresholds">Thresholds</a></li>
                <li><a href="#interpreting-results">Interpreting results</a></li>
                <li><a href="#downloads">Downloads</a></li>
                <li><a href="#troubleshooting">Troubleshooting</a></li>
                <li><a href="#api-health">API health</a></li>
                <li><a href="#psiblast">PSI-BLAST workflow</a></li>
            </ul>
        </aside>

        <div class="help-body">
            <div class="accordion">
                <details id="input-format" open>
                    <summary>Input format</summary>
                    <div class="help-section">
                        <p class="hint">Upload a CSV with at least three columns: gene ID, log2 fold change, and p-value. Map them in the run form before launching.</p>
                        <div class="media-grid">
                            <div class="media-box">Image placeholder</div>
                            <div class="media-box video">YouTube embed placeholder</div>
                        </div>
                    </div>
                </details>

                <details id="thresholds">
                    <summary>Thresholds</summary>
                    <div class="help-section">
                        <p class="hint">log2FC and p-value cutoffs filter points on the volcano plot. Distance percentile trims noisy points before calling significant genes.</p>
                        <div class="media-grid">
                            <div class="media-box">Image placeholder</div>
                            <div class="media-box video">YouTube embed placeholder</div>
                        </div>
                    </div>
                </details>

                <details id="interpreting-results">
                    <summary>Interpreting results</summary>
                    <div class="help-section">
                        <p class="hint">Click any point on the volcano plot to load annotations: GO terms, domains, KEGG, orthologous groups, fold predictions, TMHMM-style topology, and networks.</p>
                        <div class="media-grid">
                            <div class="media-box">Image placeholder</div>
                            <div class="media-box video">YouTube embed placeholder</div>
                        </div>
                    </div>
                </details>

                <details id="downloads">
                    <summary>Downloads</summary>
                    <div class="help-section">
                        <p class="hint">Use the Downloads & tables button in the results page to grab CSVs, STRING SVGs, and per-gene FASTA/PDB assets.</p>
                        <div class="media-grid">
                            <div class="media-box">Image placeholder</div>
                            <div class="media-box video">YouTube embed placeholder</div>
                        </div>
                    </div>
                </details>

                <details id="troubleshooting">
                    <summary>Troubleshooting</summary>
                    <div class="help-section">
                        <p class="hint">If a run stalls, stop it from History and relaunch. Empty plots usually mean thresholds are too strict or columns were mis-mapped.</p>
                        <div class="media-grid">
                            <div class="media-box">Image placeholder</div>
                            <div class="media-box video">YouTube embed placeholder</div>
                        </div>
                    </div>
                </details>

                <details id="api-health">
                    <summary>API health</summary>
                    <div class="help-section">
                        <p class="hint">Backend status is still available at /health even though the nav link was removed.</p>
                        <div class="media-grid">
                            <div class="media-box">Image placeholder</div>
                            <div class="media-box video">YouTube embed placeholder</div>
                        </div>
                    </div>
                </details>

                <details id="psiblast">
                    <summary>PSI-BLAST workflow</summary>
                    <div class="help-section">
                        <p class="hint">After clicking "Run PSI-BLAST" in Results, a new NCBI tab opens. Wait for the job page, then use "Formatting options" to see alignments. If the sequence box is hidden, click "Edit and resubmit"â€”the query sequence is prefilled.</p>
                        <div class="media-grid">
                            <div class="media-box">Image placeholder</div>
                            <div class="media-box video">YouTube embed placeholder</div>
                        </div>
                    </div>
                </details>
            </div>
        </div>
    </div>
</section>

<script>
    // Smooth-scroll nav and open the matching accordion section
    document.querySelectorAll('.help-nav a').forEach(link => {
        link.addEventListener('click', evt => {
            evt.preventDefault();
            const targetId = link.getAttribute('href');
            const panel = document.querySelector(targetId);
            if (panel) {
                panel.open = true;
                panel.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
        });
    });
</script>
{% endblock %}
